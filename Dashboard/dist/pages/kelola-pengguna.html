<!DOCTYPE html>
<html lang="en">
<head>
  <title>MiniMarket - Kelola Pengguna</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="MiniMarket Professional User Management">
  <meta name="keywords" content="admin, dashboard, minimarket, users, management">
  <meta name="author" content="MiniMarket">

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè™</text></svg>" type="image/svg+xml">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root {
      --primary-color: #2563eb;
      --primary-light: #dbeafe;
      --secondary-color: #64748b;
      --success-color: #059669;
      --success-light: #d1fae5;
      --warning-color: #d97706;
      --warning-light: #fef3c7;
      --danger-color: #dc2626;
      --danger-light: #fee2e2;
      --info-color: #0891b2;
      --info-light: #cffafe;
      --dark-color: #1e293b;
      --light-color: #f8fafc;
      --border-color: #e2e8f0;
      --text-muted: #64748b;
      --sidebar-width: 280px;
      --header-height: 70px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--light-color);
      color: var(--dark-color);
      line-height: 1.6;
    }

    /* Sidebar Styles */
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: var(--sidebar-width);
      height: 100vh;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      z-index: 1000;
      transition: all 0.3s ease;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar-brand {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: white;
      font-size: 1.5rem;
      font-weight: 700;
    }

    .sidebar-brand i {
      margin-right: 0.75rem;
      font-size: 2rem;
    }

    .sidebar-nav {
      padding: 1rem 0;
    }

    .nav-section {
      margin-bottom: 2rem;
    }

    .nav-section-title {
      padding: 0 1.5rem 0.5rem;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: rgba(255, 255, 255, 0.7);
    }

    .nav-item {
      margin: 0.25rem 1rem;
    }

    .nav-link {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      border-radius: 0.5rem;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .nav-link:hover,
    .nav-link.active {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      transform: translateX(4px);
    }

    .nav-link i {
      margin-right: 0.75rem;
      width: 20px;
      text-align: center;
    }

    /* Header Styles */
    .header {
      position: fixed;
      top: 0;
      left: var(--sidebar-width);
      right: 0;
      height: var(--header-height);
      background: white;
      border-bottom: 1px solid var(--border-color);
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    .header-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--dark-color);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: var(--light-color);
      border-radius: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-profile:hover {
      background: var(--primary-light);
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
    }

    /* Main Content */
    .main-content {
      margin-left: var(--sidebar-width);
      margin-top: var(--header-height);
      padding: 2rem;
      min-height: calc(100vh - var(--header-height));
    }

    /* Breadcrumb */
    .breadcrumb-container {
      margin-bottom: 2rem;
    }

    .breadcrumb {
      background: none;
      padding: 0;
      margin: 0;
    }

    .breadcrumb-item {
      color: var(--text-muted);
    }

    .breadcrumb-item.active {
      color: var(--dark-color);
      font-weight: 500;
    }

    .breadcrumb-item + .breadcrumb-item::before {
      content: ">";
      color: var(--text-muted);
    }

    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: white;
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
    }

    .stat-card.primary::before { background: var(--primary-color); }
    .stat-card.success::before { background: var(--success-color); }
    .stat-card.warning::before { background: var(--warning-color); }
    .stat-card.info::before { background: var(--info-color); }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    }

    .stat-content {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .stat-icon {
      width: 60px;
      height: 60px;
      border-radius: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }

    .stat-icon.primary { background: var(--primary-light); color: var(--primary-color); }
    .stat-icon.success { background: var(--success-light); color: var(--success-color); }
    .stat-icon.warning { background: var(--warning-light); color: var(--warning-color); }
    .stat-icon.info { background: var(--info-light); color: var(--info-color); }

    .stat-info h6 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--dark-color);
      margin-bottom: 0.25rem;
    }

    .stat-count {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 0;
    }

    .stat-count.primary { color: var(--primary-color); }
    .stat-count.success { color: var(--success-color); }
    .stat-count.warning { color: var(--warning-color); }
    .stat-count.info { color: var(--info-color); }

    /* Cards */
    .card {
      background: white;
      border-radius: 1rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      border: 1px solid var(--border-color);
      overflow: hidden;
    }

    .card-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--border-color);
      background: var(--light-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--dark-color);
      margin: 0;
    }

    .card-body {
      padding: 1.5rem;
    }

    /* Buttons */
    .btn {
      border-radius: 0.5rem;
      font-weight: 500;
      padding: 0.5rem 1rem;
      transition: all 0.3s ease;
      border: none;
    }

    .btn-primary {
      background: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }

    .btn-outline-primary {
      border: 1px solid var(--primary-color);
      color: var(--primary-color);
      background: transparent;
    }

    .btn-outline-primary:hover {
      background: var(--primary-color);
      color: white;
    }

    .btn-outline-danger {
      border: 1px solid var(--danger-color);
      color: var(--danger-color);
      background: transparent;
    }

    .btn-outline-danger:hover {
      background: var(--danger-color);
      color: white;
    }

    .btn-outline-secondary {
      border: 1px solid var(--border-color);
      color: var(--text-muted);
      background: transparent;
    }

    .btn-outline-secondary:hover {
      background: var(--secondary-color);
      color: white;
      border-color: var(--secondary-color);
    }

    /* Form Controls */
    .form-control,
    .form-select {
      border: 1px solid var(--border-color);
      border-radius: 0.5rem;
      padding: 0.75rem;
      transition: all 0.3s ease;
    }

    .form-control:focus,
    .form-select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.25);
    }

    .form-label {
      font-weight: 500;
      color: var(--dark-color);
      margin-bottom: 0.5rem;
    }

    /* Filter Controls */
    .filter-controls {
      background: white;
      padding: 1.5rem;
      border-radius: 1rem;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      border: 1px solid var(--border-color);
      margin-bottom: 1.5rem;
    }

    /* Table */
    .table-container {
      background: white;
      border-radius: 1rem;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      border: 1px solid var(--border-color);
    }

    .table {
      margin: 0;
      border-collapse: collapse;
    }

    .table th {
      background: var(--light-color);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      color: var(--dark-color);
      border-bottom: 2px solid var(--border-color);
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .table td {
      padding: 1rem;
      border-bottom: 1px solid var(--border-color);
      color: var(--dark-color);
      vertical-align: middle;
    }

    .table tbody tr:hover {
      background: var(--light-color);
    }

    .table tbody tr:last-child td {
      border-bottom: none;
    }

    /* User Avatar */
    .user-table-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
    }

    /* Status Badges */
    .status-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .status-aktif {
      background: var(--success-light);
      color: var(--success-color);
    }

    .status-tidak-aktif {
      background: var(--danger-light);
      color: var(--danger-color);
    }

    /* Role Badges */
    .role-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .role-administrator {
      background: var(--primary-light);
      color: var(--primary-color);
    }

    .role-kasir {
      background: var(--success-light);
      color: var(--success-color);
    }

    .role-staf-gudang {
      background: var(--warning-light);
      color: var(--warning-color);
    }

    .role-pelanggan {
      background: var(--info-light);
      color: var(--info-color);
    }

    /* Modal */
    .modal-content {
      border-radius: 1rem;
      border: none;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    }

    .modal-header {
      border-bottom: 1px solid var(--border-color);
      padding: 1.5rem;
    }

    .modal-title {
      font-weight: 600;
      color: var(--dark-color);
    }

    .modal-body {
      padding: 1.5rem;
    }

    .modal-footer {
      border-top: 1px solid var(--border-color);
      padding: 1.5rem;
    }

    /* Image Preview */
    .image-preview {
      max-width: 80px;
      max-height: 80px;
      border-radius: 50%;
      border: 2px solid var(--border-color);
      margin-top: 0.5rem;
    }

    /* Chart Container */
    .chart-container {
      background: white;
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      border: 1px solid var(--border-color);
      margin-bottom: 1.5rem;
    }

    /* Role Distribution */
    .role-stats-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border-color);
    }

    .role-stats-item:last-child {
      border-bottom: none;
    }

    .role-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 0.75rem;
    }

    .role-indicator.administrator { background: var(--primary-color); }
    .role-indicator.kasir { background: var(--success-color); }
    .role-indicator.staf-gudang { background: var(--warning-color); }
    .role-indicator.pelanggan { background: var(--info-color); }

    /* Pagination */
    .pagination {
      margin: 0;
    }

    .page-link {
      border: 1px solid var(--border-color);
      color: var(--dark-color);
      padding: 0.5rem 0.75rem;
      margin: 0 0.125rem;
      border-radius: 0.5rem;
      transition: all 0.3s ease;
    }

    .page-link:hover {
      background: var(--primary-color);
      border-color: var(--primary-color);
      color: white;
    }

    .page-item.active .page-link {
      background: var(--primary-color);
      border-color: var(--primary-color);
      color: white;
    }

    .page-item.disabled .page-link {
      color: var(--text-muted);
      background: var(--light-color);
      border-color: var(--border-color);
    }

    /* Footer */
    .footer {
      margin-left: var(--sidebar-width);
      padding: 1.5rem 2rem;
      background: white;
      border-top: 1px solid var(--border-color);
      text-align: center;
      color: var(--text-muted);
      font-size: 0.875rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .header {
        left: 0;
      }

      .main-content {
        margin-left: 0;
      }

      .footer {
        margin-left: 0;
      }

      .filter-controls .row > div {
        margin-bottom: 1rem;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card, .stat-card {
      animation: fadeInUp 0.6s ease forwards;
    }

    .stat-card:nth-child(1) { animation-delay: 0.1s; }
    .stat-card:nth-child(2) { animation-delay: 0.2s; }
    .stat-card:nth-child(3) { animation-delay: 0.3s; }
    .stat-card:nth-child(4) { animation-delay: 0.4s; }

    /* Action Buttons */
    .action-buttons {
      display: flex;
      gap: 0.25rem;
    }

    .action-buttons .btn {
      padding: 0.375rem 0.5rem;
      font-size: 0.875rem;
    }
  </style>
</head>

<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <a href="../../../uas_workshopui/index.html" class="sidebar-brand">
        <i class="fas fa-store"></i>
        MiniMarket
      </a>
    </div>
    
    <nav class="sidebar-nav">
      <div class="nav-section">
        <div class="nav-section-title">Main Navigation</div>
        <div class="nav-item">
          <a href="dashboard.html" class="nav-link">
            <i class="fas fa-chart-line"></i>
            Dashboard
          </a>
        </div>
        <div class="nav-item">
          <a href="kelola-produk.html" class="nav-link">
            <i class="fas fa-box"></i>
            Kelola Produk
          </a>
        </div>
        <div class="nav-item">
          <a href="kelola-transaksi.html" class="nav-link">
            <i class="fas fa-receipt"></i>
            Kelola Transaksi
          </a>
        </div>
        <div class="nav-item">
          <a href="history-transaksi.html" class="nav-link">
            <i class="fas fa-history"></i>
            History Transaksi
          </a>
        </div>
        <div class="nav-item">
          <a href="kelola-pengguna.html" class="nav-link active">
            <i class="fas fa-users"></i>
            Kelola Pengguna
          </a>
        </div>
        <div class="nav-item">
          <a href="kelola-artikel.html" class="nav-link">
            <i class="fas fa-file-alt"></i>
            Kelola Artikel
          </a>
        </div>
      </div>
    </nav>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <h1 class="header-title">Kelola Pengguna</h1>
    </div>
    <div class="header-right">
      <div class="user-profile" onclick="handleLogout()">
        <div class="user-avatar">A</div>
        <div>
          <div style="font-weight: 600; font-size: 0.875rem;">Admin</div>
          <div style="font-size: 0.75rem; color: var(--text-muted);">Administrator</div>
        </div>
        <i class="fas fa-chevron-down" style="font-size: 0.75rem; color: var(--text-muted);"></i>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Breadcrumb -->
    <div class="breadcrumb-container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="dashboard.html">Home</a></li>
          <li class="breadcrumb-item active" aria-current="page">Kelola Pengguna</li>
        </ol>
      </nav>
    </div>

    <!-- User Statistics -->
    <div class="stats-grid">
      <div class="stat-card primary">
        <div class="stat-content">
          <div class="stat-icon primary">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-info">
            <h6>Total Pengguna</h6>
            <p class="stat-count primary" id="totalUsers">8</p>
          </div>
        </div>
      </div>

      <div class="stat-card success">
        <div class="stat-content">
          <div class="stat-icon success">
            <i class="fas fa-user-check"></i>
          </div>
          <div class="stat-info">
            <h6>Pengguna Aktif</h6>
            <p class="stat-count success" id="activeUsers">6</p>
          </div>
        </div>
      </div>

      <div class="stat-card warning">
        <div class="stat-content">
          <div class="stat-icon warning">
            <i class="fas fa-user-times"></i>
          </div>
          <div class="stat-info">
            <h6>Tidak Aktif</h6>
            <p class="stat-count warning" id="inactiveUsers">2</p>
          </div>
        </div>
      </div>

      <div class="stat-card info">
        <div class="stat-content">
          <div class="stat-icon info">
            <i class="fas fa-user-plus"></i>
          </div>
          <div class="stat-info">
            <h6>Pengguna Baru</h6>
            <p class="stat-count info" id="newUsers">3</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Controls -->
    <div class="filter-controls">
      <div class="row g-3">
        <div class="col-md-4">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="Cari pengguna..." id="searchUser">
            <button class="btn btn-outline-secondary" type="button" id="searchButton">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
        <div class="col-md-3">
          <select class="form-select" id="filterRole">
            <option value="">Semua Role</option>
            <option value="Administrator">Administrator</option>
            <option value="Kasir">Kasir</option>
            <option value="Staf Gudang">Staf Gudang</option>
            <option value="Pelanggan">Pelanggan</option>
          </select>
        </div>
        <div class="col-md-3">
          <select class="form-select" id="filterStatus">
            <option value="">Semua Status</option>
            <option value="Aktif">Aktif</option>
            <option value="Tidak Aktif">Tidak Aktif</option>
          </select>
        </div>
        <div class="col-md-2">
          <button type="button" class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#userModal" id="addUserBtn">
            <i class="fas fa-plus"></i> Tambah
          </button>
        </div>
      </div>
    </div>

    <!-- Users Table -->
    <div class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Foto</th>
            <th>Nama</th>
            <th>Email</th>
            <th>No. Telepon</th>
            <th>Role</th>
            <th>Status</th>
            <th>Terdaftar</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="userTableBody">
          <!-- Users will be rendered here -->
        </tbody>
      </table>
      
      <!-- Pagination -->
      <div class="d-flex justify-content-between align-items-center p-3">
        <div>
          <span id="paginationInfo" class="text-muted">Menampilkan 0 sampai 0 dari 0 data</span>
        </div>
        <nav aria-label="User pagination">
          <ul class="pagination" id="paginationControls">
            <!-- Pagination controls will be rendered here -->
          </ul>
        </nav>
      </div>
    </div>

    <!-- Role Distribution Chart -->
    <div class="row mt-4">
      <div class="col-md-6">
        <div class="chart-container">
          <h5 class="mb-3">Distribusi Role Pengguna</h5>
          <div id="roleChart" style="height: 300px;"></div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="chart-container">
          <h5 class="mb-3">Statistik Role</h5>
          <div id="roleStats">
            <!-- Role statistics will be rendered here -->
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- User Modal -->
  <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="userModalLabel">Tambah Pengguna</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="userForm">
            <input type="hidden" id="editUserId">
            <div class="row g-3">
              <div class="col-md-6">
                <label for="userId" class="form-label">ID Pengguna</label>
                <input type="text" class="form-control" id="userId" placeholder="Otomatis" disabled>
              </div>
              <div class="col-md-6">
                <label for="userName" class="form-label">Nama Lengkap <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="userName" required>
              </div>
              <div class="col-md-6">
                <label for="userEmail" class="form-label">Email <span class="text-danger">*</span></label>
                <input type="email" class="form-control" id="userEmail" required>
              </div>
              <div class="col-md-6">
                <label for="userPhone" class="form-label">No. Telepon <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="userPhone" required>
              </div>
              <div class="col-md-6">
                <label for="userPassword" class="form-label">Password <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="userPassword" required>
                <div class="form-text">Kosongkan jika tidak ingin mengubah password (untuk edit).</div>
              </div>
              <div class="col-md-6">
                <label for="userConfirmPassword" class="form-label">Konfirmasi Password <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="userConfirmPassword" required>
              </div>
              <div class="col-md-6">
                <label for="userRole" class="form-label">Role <span class="text-danger">*</span></label>
                <select class="form-select" id="userRole" required>
                  <option value="">Pilih Role</option>
                  <option value="Administrator">Administrator</option>
                  <option value="Kasir">Kasir</option>
                  <option value="Staf Gudang">Staf Gudang</option>
                  <option value="Pelanggan">Pelanggan</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="userStatus" class="form-label">Status <span class="text-danger">*</span></label>
                <select class="form-select" id="userStatus" required>
                  <option value="Aktif">Aktif</option>
                  <option value="Tidak Aktif">Tidak Aktif</option>
                </select>
              </div>
              <div class="col-12">
                <label for="userPhoto" class="form-label">Foto Profil</label>
                <input class="form-control" type="file" id="userPhoto" accept="image/*">
                <div class="form-text">Format: JPG, PNG. Maksimal: 1MB</div>
                <img id="userPhotoPreview" src="/placeholder.svg" alt="Preview" class="image-preview" style="display: none;">
              </div>
              <div class="col-12">
                <label for="userAddress" class="form-label">Alamat</label>
                <textarea class="form-control" id="userAddress" rows="3" placeholder="Alamat lengkap pengguna"></textarea>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Batal</button>
          <button type="submit" class="btn btn-primary" id="saveUserBtn" form="userForm">
            <i class="fas fa-save"></i> Simpan
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <p>&copy; 2025 MiniMarket Professional Dashboard. All rights reserved.</p>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Sample user data
    let users = [
      {
        id: 'USR001',
        photo: 'https://plus.unsplash.com/premium_photo-1690407617542-2f210cf20d7e?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
        name: 'Ahmad Supriadi',
        email: 'ahmad@example.com',
        phone: '081234567890',
        role: 'Administrator',
        status: 'Aktif',
        registered: '01 Jan 2025',
        address: 'Jl. Contoh No. 1, Jakarta'
      },
      {
        id: 'USR002',
        photo: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
        name: 'Siti Aminah',
        email: 'siti@example.com',
        phone: '081234567891',
        role: 'Kasir',
        status: 'Aktif',
        registered: '15 Jan 2025',
        address: 'Jl. Raya No. 10, Bandung'
      },
      {
        id: 'USR003',
        photo: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8cHJvZmlsZXxlbnwwfHwwfHx8MA%3D%3D',
        name: 'Budi Santoso',
        email: 'budi@example.com',
        phone: '081234567892',
        role: 'Staf Gudang',
        status: 'Aktif',
        registered: '22 Jan 2025',
        address: 'Jl. Merdeka No. 5, Surabaya'
      },
      {
        id: 'USR004',
        photo: 'https://plus.unsplash.com/premium_photo-1673866484792-c5a36a6c025e?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
        name: 'Dewi Lestari',
        email: 'dewi@example.com',
        phone: '081234567893',
        role: 'Kasir',
        status: 'Aktif',
        registered: '05 Feb 2025',
        address: 'Jl. Pahlawan No. 7, Semarang'
      },
      {
        id: 'USR005',
        photo: 'https://images.unsplash.com/photo-1543610892-0b1f7e6d8ac1?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTR8fHByb2ZpbGV8ZW58MHx8MHx8fDA%3D',
        name: 'Joko Widodo',
        email: 'joko@example.com',
        phone: '081234567894',
        role: 'Pelanggan',
        status: 'Aktif',
        registered: '12 Feb 2025',
        address: 'Jl. Mawar No. 12, Yogyakarta'
      },
      {
        id: 'USR006',
        photo: 'https://plus.unsplash.com/premium_photo-1689977807477-a579eda91fa2?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTd8fHByb2ZpbGV8ZW58MHx8MHx8fDA%3D',
        name: 'Rina Marlina',
        email: 'rina@example.com',
        phone: '081234567895',
        role: 'Pelanggan',
        status: 'Aktif',
        registered: '20 Feb 2025',
        address: 'Jl. Anggrek No. 20, Malang'
      },
      {
        id: 'USR007',
        photo: 'https://images.unsplash.com/photo-1502823403499-6ccfcf4fb453?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTl8fHByb2ZpbGV8ZW58MHx8MHx8fDA%3D',
        name: 'Hadi Sutrisno',
        email: 'hadi@example.com',
        phone: '081234567896',
        role: 'Staf Gudang',
        status: 'Tidak Aktif',
        registered: '01 Mar 2025',
        address: 'Jl. Melati No. 3, Bali'
      },
      {
        id: 'USR008',
        photo: 'https://media.istockphoto.com/id/1501770003/photo/happy-handsome-young-indian-man-head-shot-front-portrait.webp?a=1&b=1&s=612x612&w=0&k=20&c=e8Ag8EsPlHD4gKmJGaZApE5d4m6bV6BWnQqwjIaKXoA=',
        name: 'Sinta Dewi',
        email: 'sinta@example.com',
        phone: '081234567897',
        role: 'Pelanggan',
        status: 'Tidak Aktif',
        registered: '10 Mar 2025',
        address: 'Jl. Kenanga No. 8, Medan'
      }
    ];

    let currentEditUserId = null;
    let currentPage = 1;
    const rowsPerPage = 6;

    // DOM Elements
    const userTableBody = document.getElementById('userTableBody');
    const userForm = document.getElementById('userForm');
    const saveUserBtn = document.getElementById('saveUserBtn');
    const userModalLabel = document.getElementById('userModalLabel');
    const addUserBtn = document.getElementById('addUserBtn');

    const userIdInput = document.getElementById('userId');
    const userNameInput = document.getElementById('userName');
    const userEmailInput = document.getElementById('userEmail');
    const userPhoneInput = document.getElementById('userPhone');
    const userPasswordInput = document.getElementById('userPassword');
    const userConfirmPasswordInput = document.getElementById('userConfirmPassword');
    const userRoleSelect = document.getElementById('userRole');
    const userStatusSelect = document.getElementById('userStatus');
    const userPhotoInput = document.getElementById('userPhoto');
    const userPhotoPreview = document.getElementById('userPhotoPreview');
    const userAddressTextarea = document.getElementById('userAddress');

    const searchUserInput = document.getElementById('searchUser');
    const searchButton = document.getElementById('searchButton');
    const filterRoleSelect = document.getElementById('filterRole');
    const filterStatusSelect = document.getElementById('filterStatus');

    // Render users in table
    function renderUsers(dataToRender = users) {
      userTableBody.innerHTML = '';
      const startIndex = (currentPage - 1) * rowsPerPage;
      const endIndex = startIndex + rowsPerPage;
      const paginatedUsers = dataToRender.slice(startIndex, endIndex);

      if (paginatedUsers.length === 0 && dataToRender.length > 0) {
        currentPage = Math.max(1, currentPage - 1);
        renderUsers(dataToRender);
        return;
      }

      paginatedUsers.forEach(user => {
        const row = userTableBody.insertRow();
        row.dataset.userId = user.id;

        let statusClass = user.status === 'Aktif' ? 'status-aktif' : 'status-tidak-aktif';
        let roleClass = '';
        switch (user.role) {
          case 'Administrator': roleClass = 'role-administrator'; break;
          case 'Kasir': roleClass = 'role-kasir'; break;
          case 'Staf Gudang': roleClass = 'role-staf-gudang'; break;
          case 'Pelanggan': roleClass = 'role-pelanggan'; break;
        }

        row.innerHTML = `
          <td><strong>${user.id}</strong></td>
          <td><img src="${user.photo}" alt="user" class="user-table-avatar"></td>
          <td>${user.name}</td>
          <td>${user.email}</td>
          <td>${user.phone}</td>
          <td><span class="role-badge ${roleClass}">${user.role}</span></td>
          <td><span class="status-badge ${statusClass}">${user.status}</span></td>
          <td>${user.registered}</td>
          <td>
            <div class="action-buttons">
              <button type="button" class="btn btn-outline-primary btn-sm edit-btn" data-bs-toggle="modal" data-bs-target="#userModal" title="Edit">
                <i class="fas fa-edit"></i>
              </button>
              <button type="button" class="btn btn-outline-danger btn-sm delete-btn" title="Hapus">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        `;
      });

      updatePaginationControls(dataToRender.length);
      updatePaginationInfo(dataToRender.length);
      updateStatistics(dataToRender);
      updateRoleChart(dataToRender);
    }

    // Generate unique user ID
    function generateUserId() {
      const prefix = 'USR';
      const existingIds = users.map(u => parseInt(u.id.replace(prefix, '')));
      const maxIdNum = existingIds.length > 0 ? Math.max(...existingIds) : 0;
      const newIdNum = maxIdNum + 1;
      return prefix + String(newIdNum).padStart(3, '0');
    }

    // Handle form submission
    userForm.addEventListener('submit', function(event) {
      event.preventDefault();

      const userName = userNameInput.value;
      const userEmail = userEmailInput.value;
      const userPhone = userPhoneInput.value;
      const userPassword = userPasswordInput.value;
      const userConfirmPassword = userConfirmPasswordInput.value;
      const userRole = userRoleSelect.value;
      const userStatus = userStatusSelect.value;
      const userAddress = userAddressTextarea.value;
      let userPhoto = userPhotoPreview.src || 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="%2364748b"/><text x="50" y="55" text-anchor="middle" fill="white" font-size="30">?</text></svg>';

      // Password validation
      if (userPassword && userPassword !== userConfirmPassword) {
        showToast('Password dan Konfirmasi Password tidak cocok!', 'error');
        return;
      }

      const file = userPhotoInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          userPhoto = e.target.result;
          processUserSave(userName, userEmail, userPhone, userRole, userStatus, userAddress, userPhoto);
        };
        reader.readAsDataURL(file);
      } else {
        processUserSave(userName, userEmail, userPhone, userRole, userStatus, userAddress, userPhoto);
      }
    });

    function processUserSave(userName, userEmail, userPhone, userRole, userStatus, userAddress, userPhoto) {
      const today = new Date();
      const registeredDate = today.toLocaleDateString('id-ID', {
        day: '2-digit',
        month: 'short',
        year: 'numeric'
      });

      if (currentEditUserId) {
        const userIndex = users.findIndex(u => u.id === currentEditUserId);
        if (userIndex !== -1) {
          users[userIndex] = {
            ...users[userIndex],
            name: userName,
            email: userEmail,
            phone: userPhone,
            role: userRole,
            status: userStatus,
            address: userAddress,
            photo: userPhoto
          };
          showToast('Pengguna berhasil diperbarui!', 'success');
        }
      } else {
        const newUserId = generateUserId();
        const newUser = {
          id: newUserId,
          photo: userPhoto,
          name: userName,
          email: userEmail,
          phone: userPhone,
          role: userRole,
          status: userStatus,
          registered: registeredDate,
          address: userAddress
        };
        users.push(newUser);
        showToast('Pengguna berhasil ditambahkan!', 'success');
      }

      bootstrap.Modal.getInstance(document.getElementById('userModal')).hide();
      resetUserForm();
      applyFiltersAndSorting();
    }

    // Handle image preview
    userPhotoInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          userPhotoPreview.src = e.target.result;
          userPhotoPreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        userPhotoPreview.src = '';
        userPhotoPreview.style.display = 'none';
      }
    });

    // Reset form
    function resetUserForm() {
      userForm.reset();
      userIdInput.value = 'Otomatis';
      userModalLabel.textContent = 'Tambah Pengguna';
      saveUserBtn.innerHTML = '<i class="fas fa-save"></i> Simpan';
      currentEditUserId = null;
      userPasswordInput.setAttribute('required', 'required');
      userConfirmPasswordInput.setAttribute('required', 'required');
      userPhotoPreview.src = '';
      userPhotoPreview.style.display = 'none';
    }

    // Add user button
    addUserBtn.addEventListener('click', function() {
      resetUserForm();
    });

    // Handle edit and delete buttons
    userTableBody.addEventListener('click', function(event) {
      const editBtn = event.target.closest('.edit-btn');
      const deleteBtn = event.target.closest('.delete-btn');

      if (editBtn) {
        const row = editBtn.closest('tr');
        const userId = row.dataset.userId;
        const user = users.find(u => u.id === userId);

        if (user) {
          userModalLabel.textContent = 'Edit Pengguna';
          saveUserBtn.innerHTML = '<i class="fas fa-save"></i> Perbarui';
          currentEditUserId = user.id;

          userIdInput.value = user.id;
          userNameInput.value = user.name;
          userEmailInput.value = user.email;
          userPhoneInput.value = user.phone;
          userRoleSelect.value = user.role;
          userStatusSelect.value = user.status;
          userAddressTextarea.value = user.address || '';

          userPasswordInput.removeAttribute('required');
          userConfirmPasswordInput.removeAttribute('required');

          if (user.photo) {
            userPhotoPreview.src = user.photo;
            userPhotoPreview.style.display = 'block';
          } else {
            userPhotoPreview.src = '';
            userPhotoPreview.style.display = 'none';
          }
        }
      } else if (deleteBtn) {
        const row = deleteBtn.closest('tr');
        const userId = row.dataset.userId;
        const user = users.find(u => u.id === userId);
        
        if (confirm(`Apakah Anda yakin ingin menghapus pengguna "${user.name}"?`)) {
          users = users.filter(u => u.id !== userId);
          showToast('Pengguna berhasil dihapus!', 'success');
          applyFiltersAndSorting();
        }
      }
    });

    // Search, filter, and sort
    function applyFiltersAndSorting() {
      let filteredUsers = [...users];

      const searchTerm = searchUserInput.value.toLowerCase().trim();
      if (searchTerm) {
        filteredUsers = filteredUsers.filter(user =>
          user.name.toLowerCase().includes(searchTerm) ||
          user.id.toLowerCase().includes(searchTerm) ||
          user.email.toLowerCase().includes(searchTerm) ||
          user.phone.toLowerCase().includes(searchTerm)
        );
      }

      const selectedRole = filterRoleSelect.value;
      if (selectedRole) {
        filteredUsers = filteredUsers.filter(user => user.role === selectedRole);
      }

      const selectedStatus = filterStatusSelect.value;
      if (selectedStatus) {
        filteredUsers = filteredUsers.filter(user => user.status === selectedStatus);
      }

      renderUsers(filteredUsers);
    }

    // Update statistics
    function updateStatistics(usersData) {
      document.getElementById('totalUsers').textContent = usersData.length;
      document.getElementById('activeUsers').textContent = usersData.filter(u => u.status === 'Aktif').length;
      document.getElementById('inactiveUsers').textContent = usersData.filter(u => u.status === 'Tidak Aktif').length;
      
      const currentMonth = new Date().toLocaleString('en-US', { month: 'short' }).replace(/\./g, '') + ' ' + new Date().getFullYear();
      document.getElementById('newUsers').textContent = usersData.filter(u => u.registered.includes(currentMonth)).length;
    }

    // Update role chart
    function updateRoleChart(usersData) {
      const roleCounts = usersData.reduce((acc, user) => {
        acc[user.role] = (acc[user.role] || 0) + 1;
        return acc;
      }, {});

      const roles = ['Administrator', 'Kasir', 'Staf Gudang', 'Pelanggan'];
      const colors = ['#2563eb', '#059669', '#d97706', '#0891b2'];
      
      // Simple chart representation
      const chartContainer = document.getElementById('roleChart');
      chartContainer.innerHTML = '';
      
      const total = usersData.length;
      roles.forEach((role, index) => {
        const count = roleCounts[role] || 0;
        const percentage = total > 0 ? (count / total * 100) : 0;
        
        const chartItem = document.createElement('div');
        chartItem.style.marginBottom = '1rem';
        chartItem.innerHTML = `
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div class="d-flex align-items-center">
              <div class="role-indicator ${role.toLowerCase().replace(' ', '-')}" style="background: ${colors[index]}"></div>
              <span>${role}</span>
            </div>
            <span>${count} (${percentage.toFixed(0)}%)</span>
          </div>
          <div class="progress" style="height: 8px;">
            <div class="progress-bar" style="width: ${percentage}%; background: ${colors[index]}"></div>
          </div>
        `;
        chartContainer.appendChild(chartItem);
      });

      // Update role stats
      const roleStatsContainer = document.getElementById('roleStats');
      roleStatsContainer.innerHTML = '';
      roles.forEach((role, index) => {
        const count = roleCounts[role] || 0;
        const percentage = total > 0 ? (count / total * 100) : 0;
        
        const statsItem = document.createElement('div');
        statsItem.className = 'role-stats-item';
        statsItem.innerHTML = `
          <div class="d-flex align-items-center">
            <div class="role-indicator ${role.toLowerCase().replace(' ', '-')}" style="background: ${colors[index]}"></div>
            <span>${role}</span>
          </div>
          <span><strong>${count}</strong> (${percentage.toFixed(0)}%)</span>
        `;
        roleStatsContainer.appendChild(statsItem);
      });
    }

    // Pagination
    function updatePaginationControls(totalItems) {
      const totalPages = Math.ceil(totalItems / rowsPerPage);
      const paginationControls = document.getElementById('paginationControls');
      paginationControls.innerHTML = '';

      const createPageItem = (pageNumber, text, isDisabled, isActive) => {
        const li = document.createElement('li');
        li.classList.add('page-item');
        if (isDisabled) li.classList.add('disabled');
        if (isActive) li.classList.add('active');

        const a = document.createElement('a');
        a.classList.add('page-link');
        a.href = '#';
        a.textContent = text;
        a.addEventListener('click', (e) => {
          e.preventDefault();
          if (!isDisabled && !isActive) {
            currentPage = pageNumber;
            applyFiltersAndSorting();
          }
        });
        li.appendChild(a);
        return li;
      };

      paginationControls.appendChild(createPageItem(currentPage - 1, 'Previous', currentPage === 1, false));

      for (let i = 1; i <= totalPages; i++) {
        paginationControls.appendChild(createPageItem(i, i, false, i === currentPage));
      }

      paginationControls.appendChild(createPageItem(currentPage + 1, 'Next', currentPage === totalPages || totalPages === 0, false));
    }

    function updatePaginationInfo(totalItems) {
      const paginationInfo = document.getElementById('paginationInfo');
      const startIndex = (currentPage - 1) * rowsPerPage + 1;
      const endIndex = Math.min(startIndex + rowsPerPage - 1, totalItems);
      paginationInfo.textContent = `Menampilkan ${totalItems === 0 ? 0 : startIndex} sampai ${endIndex} dari ${totalItems} data`;
    }

    // Toast notification
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.style.position = 'fixed';
      toast.style.top = '20px';
      toast.style.right = '20px';
      toast.style.padding = '15px 25px';
      toast.style.borderRadius = '0.5rem';
      toast.style.color = 'white';
      toast.style.fontWeight = '500';
      toast.style.zIndex = '9999';
      toast.style.opacity = '0';
      toast.style.transform = 'translateY(-20px)';
      toast.style.transition = 'all 0.3s ease';
      
      if (type === 'success') {
        toast.style.background = 'var(--success-color)';
      } else if (type === 'error') {
        toast.style.background = 'var(--danger-color)';
      }
      
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => {
        toast.style.opacity = '1';
        toast.style.transform = 'translateY(0)';
      }, 100);

      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(-20px)';
        setTimeout(() => {
          document.body.removeChild(toast);
        }, 300);
      }, 3000);
    }

    // Event listeners
    searchButton.addEventListener('click', applyFiltersAndSorting);
    searchUserInput.addEventListener('keyup', applyFiltersAndSorting);
    filterRoleSelect.addEventListener('change', applyFiltersAndSorting);
    filterStatusSelect.addEventListener('change', applyFiltersAndSorting);

    // Logout functionality
    function handleLogout() {
      if (confirm('Apakah Anda yakin ingin logout?')) {
        showToast('Logout berhasil!', 'success');
        setTimeout(() => {
          alert('Redirect to login page');
        }, 1000);
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      applyFiltersAndSorting();
    });
  </script>
</body>
</html>